<!DOCTYPE html>
<html>
  <head>
    
    <title>Crunchy PostgreSQL Operator Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.55.6" />
<title>Common pgo Client Tasks :: Crunchy PostgreSQL Operator Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/postgres-operator/4.4.3/favicon.png" type="image/x-icon" />
<link href="https://crunchydata.github.io/postgres-operator/4.4.3/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/4.4.3/theme-flex/style.css" rel="stylesheet">

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link href="https://crunchydata.github.io/postgres-operator/4.4.3/css/Fort-Fonts.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/4.4.3/css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<script src="https://crunchydata.github.io/postgres-operator/4.4.3/js/jquery-2.x.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
<script src="https://crunchydata.github.io/postgres-operator/4.4.3/js/main.js"></script>
<script src="https://crunchydata.github.io/postgres-operator/4.4.3/js/toc.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/4.4.3";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/pgo-client/common-tasks/">
    
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  
<a class="navbar-brand" href="https://www.crunchydata.com/"><img alt="Crunchy Data" src="https://crunchydata.github.io/postgres-operator/4.4.3/images/logo.svg"></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <ul class="navbar-nav mr-auto"></ul>
  <span class="navbar-text">
      <nav class="shortcuts">
              <li class="" role="">
                  <a href="https://crunchydata.github.io/postgres-operator/4.4.3/" target="_blank" rel="noopener">
                    <label>Overview</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator" target="_blank" rel="noopener">
                    <i class='fab fa-github'></i> <label>Source</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">
                    <i class='fas fa-bookmark'></i> <label>Kubernetes</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator/blob/master/LICENSE.md" target="_blank" rel="noopener">
                    <i class='fas fa-file-contract'></i> <label>License</label>
                  </a>
              </li>
      </nav>
  </span>
</nav>

<article>
  <aside>

    <ul class="menu">
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/4.4.3/js/lunr.min.js"></script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/4.4.3/js/auto-complete.js"></script>
        <link href="https://crunchydata.github.io/postgres-operator/4.4.3/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/4.4.3";
          
        </script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/4.4.3/js/search.js"></script>
      </div>

      <hr>
      <a class="baselink" href="https://crunchydata.github.io/postgres-operator/4.4.3/">Crunchy PostgreSQL Operator Documentation</a>
      <hr>
        <b>Available Formats</b>
        <nav class="downloads">
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pdf/postgres_operator.pdf" target="_blank" rel="noopener">
                      <i class='fas fa-file-pdf'></i> <label>PDF</label>
                    </a>
                </li>
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/4.4.3/epub/postgres_operator.epub" target="_blank" rel="noopener">
                      <i class='fas fa-book'></i> <label>EPUB</label>
                    </a>
                </li>
        </nav>
        <hr>

      <b>Navigation</b>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/quickstart/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/quickstart/">Quickstart</a>

      </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/">Architecture</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/overview/">
            Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/provisioning/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/provisioning/">
            Provisioning
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/disaster-recovery/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/disaster-recovery/">
            Disaster Recovery
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/">High-Availability</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/multi-cluster-kubernetes/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/multi-cluster-kubernetes/">
            Kubernetes Multi-Cluster Deployments
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/namespace/">
            Namespace Management
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/eventing/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/eventing/">
            Lifecycle Events
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/postgres-operator-containers-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/postgres-operator-containers-overview/">
            PostgreSQL Containers
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/storage-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/storage-overview/">
            Storage
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/users-role-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/users-role-overview/">
            User &amp; Roles
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/tablespaces/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/tablespaces/">
            Tablespaces
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/pgadmin4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/pgadmin4/">
            pgAdmin 4
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/">Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/compatibility/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/compatibility/">
            Compatibility Requirements
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/configuration/">
            Configuration Resources
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/pgo-yaml-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/pgo-yaml-configuration/">
            PGO YAML
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/tls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/configuration/tls/">
            TLS
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/">Installation</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/prerequisites/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/prerequisites/">
            Prerequisites
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/postgres-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/postgres-operator/">
            Install the PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/pgo-client/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/pgo-client/">
            Install `pgo` Client
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/configuration/">
            Configuration Reference
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/">Other Methods</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/">Ansible</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/prerequisites/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/prerequisites/">
            Prerequisites
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-ansible/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-ansible/">
            Installing Ansible
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-operator/">
            Installing PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-metrics/">
            Installing Metrics Infrastructure
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/updating-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/updating-operator/">
            Updating PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/uninstalling-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/uninstalling-operator/">
            Uninstalling PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/uninstalling-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/uninstalling-metrics/">
            Uninstalling Metrics Stack
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/bash/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/bash/">
            Bash Scripts
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/helm/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/helm/">
            Helm Chart
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/">Using the pgo Client</a>
            <i class="fas fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/common-tasks/" class="dd-item active">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/common-tasks/">
            Common pgo Client Tasks
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/">pgo Client Reference</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_apply/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_apply/">
            pgo apply
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_backup/">
            pgo backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_cat/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_cat/">
            pgo cat
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_clone/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_clone/">
            pgo clone
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create/">
            pgo create
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/">
            pgo create cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_namespace/">
            pgo create namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgadmin/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgadmin/">
            pgo create pgadmin
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgbouncer/">
            pgo create pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgorole/">
            pgo create pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgouser/">
            pgo create pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_policy/">
            pgo create policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_schedule/">
            pgo create schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_user/">
            pgo create user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete/">
            pgo delete
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_backup/">
            pgo delete backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_cluster/">
            pgo delete cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_label/">
            pgo delete label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_namespace/">
            pgo delete namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgadmin/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgadmin/">
            pgo delete pgadmin
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgbouncer/">
            pgo delete pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgorole/">
            pgo delete pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgouser/">
            pgo delete pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_policy/">
            pgo delete policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_schedule/">
            pgo delete schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_user/">
            pgo delete user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_df/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_df/">
            pgo df
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_failover/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_failover/">
            pgo failover
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_label/">
            pgo label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_load/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_load/">
            pgo load
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_reload/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_reload/">
            pgo reload
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_restart/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_restart/">
            pgo restart
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_restore/">
            pgo restore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_scale/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_scale/">
            pgo scale
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_scaledown/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_scaledown/">
            pgo scaledown
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show/">
            pgo show
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_backup/">
            pgo show backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_cluster/">
            pgo show cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_config/">
            pgo show config
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_namespace/">
            pgo show namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgadmin/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgadmin/">
            pgo show pgadmin
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgbouncer/">
            pgo show pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgorole/">
            pgo show pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pgouser/">
            pgo show pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_policy/">
            pgo show policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pvc/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_pvc/">
            pgo show pvc
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_schedule/">
            pgo show schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_user/">
            pgo show user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_workflow/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_workflow/">
            pgo show workflow
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_status/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_status/">
            pgo status
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_test/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_test/">
            pgo test
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update/">
            pgo update
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_cluster/">
            pgo update cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_namespace/">
            pgo update namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_pgbouncer/">
            pgo update pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_pgorole/">
            pgo update pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_pgouser/">
            pgo update pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_user/">
            pgo update user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_upgrade/">
            pgo upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_version/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_version/">
            pgo version
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_watch/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_watch/">
            pgo watch
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/custom-resources/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/custom-resources/">Using Custom Resources</a>

      </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/security/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/security/">RBAC Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/security/configure-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/security/configure-postgres-operator-rbac/">
            Configuration of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/security/install-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/security/install-postgres-operator-rbac/">
            Installation of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/security/api-encryption-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/security/api-encryption-configuration/">
            PostgreSQL Operator API Encryption Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/">Advanced Topics</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/">
            Custom Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/multi-zone-design-considerations/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/multi-zone-design-considerations/">
            Multi-Zone Cloud Considerations
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/direct-api-calls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/direct-api-calls/">
            Rest API
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/">Upgrade</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/automatedupgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/automatedupgrade/">
            Automated PostgreSQL Operator Upgrade - Operator 4.1&#43;
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/manual/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/manual/">Manual Upgrades</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/manual/upgrade35/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/manual/upgrade35/">
            Manual Upgrade - Operator 3.5
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/manual/upgrade4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/upgrade/manual/upgrade4/">
            Manual Upgrade - Operator 4
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/">Contributing</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/developer-setup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/developer-setup/">
            Development Environment
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/documentation-updates/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/documentation-updates/">
            Updating Documentation
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/issues/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/issues/">
            Submitting Issues
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/pull-requests/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/pull-requests/">
            Submitting Pull Requests
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/">Release Notes</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.3/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.3/">
            4.4.3
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.2/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.2/">
            4.4.2
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.1/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.1/">
            4.4.1
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.0/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.4.0/">
            4.4.0
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.3/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.3/">
            4.3.3
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.2/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.2/">
            4.3.2
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.1/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.1/">
            4.3.1
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.0/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.3.0/">
            4.3.0
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.2.2/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.2.2/">
            4.2.2
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.2.1/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.2.1/">
            4.2.1
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.2.0/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.2.0/">
            4.2.0
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.1.2/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.1.2/">
            4.1.2
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.1.1/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.1.1/">
            4.1.1
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.1.0/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/4.4.3/releases/4.1.0/">
            4.1.0
          </a>
        </div>
    </li>
        </ul>
    </li>




      <hr><nav id="TableOfContents"></nav>



      <section>
      </section>
    </ul>
  </aside>
  <section class="page">

    <div class="nav-select">
      <center>Navigation :
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/quickstart/" >
   Quickstart</option>
    <option value="/architecture/" >
   Architecture</option>
    <option value="/configuration/" >
   Configuration</option>
    <option value="/installation/" >
   Installation</option>
    <option value="/pgo-client/" >
   Using the pgo Client</option> 
      <option value="/pgo-client/common-tasks/"  selected>- Common pgo Client Tasks</option>
    <option value="/pgo-client/reference/" >
  - 
   pgo Client Reference</option>
  
    <option value="/custom-resources/" >
   Using Custom Resources</option>
    <option value="/security/" >
   RBAC Configuration</option>
    <option value="/advanced/" >
   Advanced Topics</option>
    <option value="/upgrade/" >
   Upgrade</option>
    <option value="/contributing/" >
   Contributing</option>
    <option value="/releases/" >
   Release Notes</option>



        </select>
      </center>
    </div>

    
      <div id="top-bar">
        
          
          
          
        <div id="top-github-link">
          <a class="github-link" href="https://crunchydata.github.io/postgres-operator/4.4.3/contributing/" target="blank">
            <i class="fa fa-info-circle"></i>
            
          </a>
          <a class="github-link" href="https://github.com/CrunchyData/postgres-operator/edit/master/docs/content/pgo-client/common-tasks.md" target="blank">
            <i class="fa fa-code-fork"></i>
            
          </a>
        </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            <span class="links">
            







 <a href='https://crunchydata.github.io/postgres-operator/4.4.3/'>Crunchy PostgreSQL Operator</a> > <a href='https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/'>Using the pgo Client</a> > Common pgo Client Tasks

 

 


            </span>
        </div>

      </div>
    

    
    <div id="body-inner">

    <h1>Common pgo Client Tasks</h1>

    

    
    

<p>While the full <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/"><code>pgo</code> client reference</a> will tell you
everything you need to know about how to use <code>pgo</code>, it may be helpful to see
several examples on how to conduct &ldquo;day-in-the-life&rdquo; tasks for administrating
PostgreSQL cluster with the PostgreSQL Operator.</p>

<p>The below guide covers many of the common operations that are required when
managing PostgreSQL clusters. The guide is broken up by different administrative
topics, such as provisioning, high-availability, etc.</p>

<h2 id="setup-before-running-the-examples">Setup Before Running the Examples</h2>

<p>Many of the <code>pgo</code> client commands require you to specify a namespace via the
<code>-n</code> or <code>--namespace</code> flag. While this is a very helpful tool when managing
PostgreSQL deployxments across many Kubernetes namespaces, this can become
onerous for the intents of this guide.</p>

<p>If you install the PostgreSQL Operator using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/quickstart/">quickstart</a>
guide, you will install the PostgreSQL Operator to a namespace called <code>pgo</code>. We
can choose to always use one of these namespaces by setting the <code>PGO_NAMESPACE</code>
environmental variable, which is detailed in the global <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/"><code>pgo</code> Client</a>
reference,</p>

<p>For convenience, we will use the <code>pgo</code> namespace in the examples below.
For even more convenience, we recommend setting <code>pgo</code> to be the value of
the <code>PGO_NAMESPACE</code> variable. In the shell that you will be executing the <code>pgo</code>
commands in, run the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#111">export</span> <span style="color:#111">PGO_NAMESPACE</span><span style="color:#f92672">=</span>pgo</code></pre></div>
<p>If you do not wish to set this environmental variable, or are in an environment
where you are unable to use environmental variables, you will have to use the
<code>--namespace</code> (or <code>-n</code>) flag for most commands, e.g.</p>

<p><code>pgo version -n pgo</code></p>

<h3 id="json-output">JSON Output</h3>

<p>The default for the <code>pgo</code> client commands is to output their results in a
readable format. However, there are times where it may be helpful to you to have
the format output in a machine parseable format like JSON.</p>

<p>Several commands support the <code>-o</code>/<code>--output</code> flags that delivers the results of
the command in the specified output. Presently, the only output that is
supported is <code>json</code>.</p>

<p>As an example of using this feature, if you wanted to get the results of the
<code>pgo test</code> command in JSON, you could run the following:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo <span style="color:#111">test</span> hacluster -o json</code></pre></div>
<h2 id="postgresql-operator-system-basics">PostgreSQL Operator System Basics</h2>

<p>To get started, it&rsquo;s first important to understand the basics of working with
the PostgreSQL Operator itself. You should know how to test if the PostgreSQL
Operator is working, check the overall status of the PostgreSQL Operator, view
the current configuration that the PostgreSQL Operator us using, and seeing
which Kubernetes Namespaces the PostgreSQL Operator has access to.</p>

<p>While this may not be as fun as creating high-availability PostgreSQL clusters,
these commands will help you to perform basic troubleshooting tasks in your
environment.</p>

<h3 id="checking-connectivity-to-the-postgresql-operator">Checking Connectivity to the PostgreSQL Operator</h3>

<p>A common task when working with the PostgreSQL Operator is to check connectivity
to the PostgreSQL Operator. This can be accomplish with the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_version/"><code>pgo version</code></a>
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo version</code></pre></div>
<p>which, if working, will yield results similar to:</p>

<pre><code>pgo client version 4.4.3
pgo-apiserver version 4.4.3
</code></pre>

<h3 id="inspecting-the-postgresql-operator-configuration">Inspecting the PostgreSQL Operator Configuration</h3>

<p>The <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_status/"><code>pgo show config</code></a> command allows you to
view the current configuration that the PostgreSQL Operator is using. This can
be helpful for troubleshooting issues such as which PostgreSQL images are being
deployed by default, which storage classes are being used, etc.</p>

<p>You can run the <code>pgo show config</code> command by running:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show config</code></pre></div>
<p>which yields output similar to:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">BasicAuth<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
Cluster<span style="color:#111">:</span>
  CCPImagePrefix<span style="color:#111">:</span> crunchydata
  CCPImageTag<span style="color:#111">:</span> centos7-12.6-4.4.3
  Policies<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
  Metrics<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  Badger<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  Port<span style="color:#111">:</span> <span style="color:#d88200">&#34;5432&#34;</span>
  PGBadgerPort<span style="color:#111">:</span> <span style="color:#d88200">&#34;10000&#34;</span>
  ExporterPort<span style="color:#111">:</span> <span style="color:#d88200">&#34;9187&#34;</span>
  User<span style="color:#111">:</span> testuser
  Database<span style="color:#111">:</span> userdb
  PasswordAgeDays<span style="color:#111">:</span> <span style="color:#d88200">&#34;60&#34;</span>
  PasswordLength<span style="color:#111">:</span> <span style="color:#d88200">&#34;8&#34;</span>
  Replicas<span style="color:#111">:</span> <span style="color:#d88200">&#34;0&#34;</span>
  ServiceType<span style="color:#111">:</span> ClusterIP
  BackrestPort<span style="color:#111">:</span> <span style="color:#ae81ff">2022</span>
  Backrest<span style="color:#111">:</span> <span style="color:#00a8c8">true</span>
  BackrestS3Bucket<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
  BackrestS3Endpoint<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
  BackrestS3Region<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
  BackrestS3URIStyle<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
  BackrestS3VerifyTLS<span style="color:#111">:</span> <span style="color:#00a8c8">true</span>
  DisableAutofail<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  PgmonitorPassword<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
  EnableCrunchyadm<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  DisableReplicaStartFailReinit<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  PodAntiAffinity<span style="color:#111">:</span> preferred
  SyncReplication<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
Pgo<span style="color:#111">:</span>
  Audit<span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  PGOImagePrefix<span style="color:#111">:</span> crunchydata
  PGOImageTag<span style="color:#111">:</span> centos7-4.4.3
PrimaryStorage<span style="color:#111">:</span> nfsstorage
BackupStorage<span style="color:#111">:</span> nfsstorage
ReplicaStorage<span style="color:#111">:</span> nfsstorage
BackrestStorage<span style="color:#111">:</span> nfsstorage
Storage<span style="color:#111">:</span>
  nfsstorage<span style="color:#111">:</span>
    AccessMode<span style="color:#111">:</span> ReadWriteMany
    Size<span style="color:#111">:</span> 1G
    StorageType<span style="color:#111">:</span> create
    StorageClass<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span>
    SupplementalGroups<span style="color:#111">:</span> <span style="color:#d88200">&#34;65534&#34;</span>
    MatchLabels<span style="color:#111">:</span> <span style="color:#d88200">&#34;&#34;</span></code></pre></div>
<h3 id="viewing-postgresql-operator-key-metrics">Viewing PostgreSQL Operator Key Metrics</h3>

<p>The <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_status/"><code>pgo status</code></a> command provides a
generalized statistical view of the overall resource consumption of the
PostgreSQL Operator. These stats include:</p>

<ul>
<li>The total number of PostgreSQL instances</li>
<li>The total number of Persistent Volume Claims (PVC) that are allocated, along with the total amount of disk the claims specify</li>
<li>The types of container images that are deployed, along with how many are deployed</li>
<li>The nodes that are used by the PostgreSQL Operator</li>
</ul>

<p>and more</p>

<p>You can use the <code>pgo status</code> command by running:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo status</code></pre></div>
<p>which yields output similar to:</p>

<pre><code>Databases:               8
Claims:                  8
Total Volume Size:       8Gi       

Database Images:
                         4	crunchydata/crunchy-postgres-ha:centos7-12.6-4.4.3
                         4	crunchydata/pgo-backrest-repo:centos7-4.4.3
                         8	crunchydata/pgo-backrest:centos7-4.4.3

Databases Not Ready:

Labels (count &gt; 1): [count] [label]
	[8]	[vendor=crunchydata]
	[4]	[pgo-backrest-repo=true]
	[4]	[pgouser=admin]
	[4]	[pgo-pg-database=true]
	[4]	[crunchy_collect=false]
	[4]	[pg-pod-anti-affinity=]
	[4]	[pgo-version=4.4.3]
	[4]	[archive-timeout=60]
	[2]	[pg-cluster=hacluster]
</code></pre>

<h3 id="viewing-postgresql-operator-managed-namespaces">Viewing PostgreSQL Operator Managed Namespaces</h3>

<p>The PostgreSQL Operator has the ability to manage PostgreSQL clusters across
Kubernetes Namespaces. During the course of Operations, it can be helpful to
know which namespaces the PostgreSQL Operator can use for deploying PostgreSQL
clusters.</p>

<p>You can view which namespaces the PostgreSQL Operator can utilize by using
the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_namespace/"><code>pgo show namespace</code></a> command. To
list out the namespaces that the PostgreSQL Operator has access to, you can run
the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show namespace --all</code></pre></div>
<p>which yields output similar to:</p>

<pre><code>pgo username: admin
namespace                useraccess          installaccess       
default                  accessible          no access           
kube-node-lease          accessible          no access           
kube-public              accessible          no access           
kube-system              accessible          no access           
pgo                      accessible          no access           
pgouser1                 accessible          accessible          
pgouser2                 accessible          accessible          
somethingelse            no access           no access   
</code></pre>

<p><strong>NOTE</strong>: Based on your deployment, your Kubernetes administrator may restrict
access to the multi-namespace feature of the PostgreSQL Operator. In this case,
you do not need to worry about managing your namespaces and as such do not need
to use this command, but we recommend setting the <code>PGO_NAMESPACE</code> variable as
described in the <a href="#general-notes">general notes</a> on this page.</p>

<h2 id="provisioning-create-view-destroy">Provisioning: Create, View, Destroy</h2>

<h3 id="creating-a-postgresql-cluster">Creating a PostgreSQL Cluster</h3>

<p>You can create a cluster using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/"><code>pgo create cluster</code></a>
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster</code></pre></div>
<p>which if successfully, will yield output similar to this:</p>

<pre><code>created Pgcluster hacluster
workflow id ae714d12-f5d0-4fa9-910f-21944b41dec8
</code></pre>

<h4 id="create-a-postgresql-cluster-with-different-pvc-sizes">Create a PostgreSQL Cluster with Different PVC Sizes</h4>

<p>You can also create a PostgreSQL cluster with an arbitrary PVC size using the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/"><code>pgo create cluster</code></a> command. For
example, if you want to create a PostgreSQL cluster with with a 128GB PVC, you
can use the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster --pvc-size<span style="color:#f92672">=</span>128Gi</code></pre></div>
<p>The above command sets the PVC size for all PostgreSQL instances in the cluster,
i.e. the primary and replicas.</p>

<p>This also extends to the size of the pgBackRest repository as well, if you are
using the local Kubernetes cluster storage for your backup repository. To
create a PostgreSQL cluster with a pgBackRest repository that uses a 1TB PVC,
you can use the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster --pgbackrest-pvc-size<span style="color:#f92672">=</span>1Ti</code></pre></div>
<h4 id="specify-cpu-memory-for-a-postgresql-cluster">Specify CPU / Memory for a PostgreSQL Cluster</h4>

<p>To specify the amount of CPU and memory to request for a PostgreSQL cluster, you
can use the <code>--cpu</code> and <code>--memory</code> flags of the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/"><code>pgo create cluster</code></a> command. Both
of these values utilize the <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/">Kubernetes quantity format</a>
for specifying how to allocate resources.</p>

<p>For example, to create a PostgreSQL cluster that requests 4 CPU cores and has 16
gibibytes of memory, you can use the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster --cpu<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span> --memory<span style="color:#f92672">=</span>16Gi</code></pre></div>
<h4 id="create-a-postgresql-cluster-with-postgis">Create a PostgreSQL Cluster with PostGIS</h4>

<p>To create a PostgreSQL cluster that uses the geospatial extension PostGIS, you
can execute the following command, updated with your desired image tag. In the
example below, the cluster will use PostgreSQL 12.6 and PostGIS 3.0:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hagiscluster <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --ccp-image<span style="color:#f92672">=</span>crunchy-postgres-gis-ha <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --ccp-image-tag<span style="color:#f92672">=</span>centos7-12.6-3.0-4.4.3</code></pre></div>
<h4 id="create-a-postgresql-cluster-with-a-tablespace">Create a PostgreSQL Cluster with a Tablespace</h4>

<p>Tablespaces are a PostgreSQL feature that allows a user to select specific
volumes to store data to, which is helpful in <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/tablespaces/">several types of scenarios</a>.
Often your workload does not require a tablespace, but the PostgreSQL Operator
provides support for tablespaces throughout the lifecycle of a PostgreSQL
cluster.</p>

<p>To create a PostgreSQL cluster that uses the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/tablespaces/">tablespace</a>
feature with NFS storage, you can execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hactsluster --tablespace<span style="color:#f92672">=</span><span style="color:#111">name</span><span style="color:#f92672">=</span>ts1:storageconfig<span style="color:#f92672">=</span>nfsstorage</code></pre></div>
<p>You can use your preferred storage engine instead of <code>nfsstorage</code>. For example,
to create multiple tablespaces on GKE, you can execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hactsluster <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    --tablespace<span style="color:#f92672">=</span><span style="color:#111">name</span><span style="color:#f92672">=</span>ts1:storageconfig<span style="color:#f92672">=</span>gce <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    --tablespace<span style="color:#f92672">=</span><span style="color:#111">name</span><span style="color:#f92672">=</span>ts2:storageconfig<span style="color:#f92672">=</span>gce</code></pre></div>
<p>Tablespaces are immediately available once the PostgreSQL cluster is
provisioned. For example, to create a table using the tablespace <code>ts1</code>, you can
run the following SQL on your PostgreSQL cluster:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#00a8c8">CREATE</span> <span style="color:#00a8c8">TABLE</span> <span style="color:#111">sensor_data</span> <span style="color:#111">(</span>
  <span style="color:#111">id</span> <span style="color:#111">int</span> <span style="color:#00a8c8">GENERATED</span> <span style="color:#00a8c8">BY</span> <span style="color:#00a8c8">DEFAULT</span> <span style="color:#00a8c8">AS</span> <span style="color:#00a8c8">IDENTITY</span> <span style="color:#00a8c8">PRIMARY</span> <span style="color:#00a8c8">KEY</span><span style="color:#111">,</span>
  <span style="color:#111">sensor1</span> <span style="color:#111">numeric</span><span style="color:#111">,</span>
  <span style="color:#111">sensor2</span> <span style="color:#111">numeric</span><span style="color:#111">,</span>
  <span style="color:#111">sensor3</span> <span style="color:#111">numeric</span><span style="color:#111">,</span>
  <span style="color:#111">sensor4</span> <span style="color:#111">numeric</span>
<span style="color:#111">)</span>
<span style="color:#111">TABLESPACE</span> <span style="color:#111">ts1</span><span style="color:#111">;</span></code></pre></div>
<p>You can also create tablespaces that have different sized PVCs from the ones
defined in the storage specification. For instance, to create two tablespaces,
one that uses a 10GiB PVC and one that uses a 20GiB PVC, you can execute the
following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hactsluster <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    --tablespace<span style="color:#f92672">=</span><span style="color:#111">name</span><span style="color:#f92672">=</span>ts1:storageconfig<span style="color:#f92672">=</span>gce:pvcsize<span style="color:#f92672">=</span>10Gi <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    --tablespace<span style="color:#f92672">=</span><span style="color:#111">name</span><span style="color:#f92672">=</span>ts2:storageconfig<span style="color:#f92672">=</span>gce:pvcsize<span style="color:#f92672">=</span>20Gi</code></pre></div>
<h4 id="create-a-postgresql-cluster-using-a-backup-from-another-postgresql-cluster">Create a PostgreSQL Cluster Using a Backup from Another PostgreSQL Cluster</h4>

<p>It is also possible to create a new PostgreSQL Cluster using a backup from another
PostgreSQL cluster.  To do so, simply specify the cluster containing the backup
that you would like to utilize using the <code>restore-from</code> option:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster2 --restore-from<span style="color:#f92672">=</span>hacluster1</code></pre></div>
<p>When using this approach, a <code>pgbackrest restore</code> will be performed using the pgBackRest
repository for the <code>restore-from</code> cluster specified in order to populate the initial
<code>PGDATA</code> directory for the new PostgreSQL cluster.  By default, pgBackRest will restore
to the latest backup available and replay all WAL.  However, a <code>restore-opts</code> option
is also available that allows the <code>restore</code> command to be further customized, e.g. to
perform a point-in-time restore and/or restore from an S3 storage bucket:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster2 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --restore-from<span style="color:#f92672">=</span>hacluster1 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --restore-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--repo-type=s3 --type=time --target=&#39;2020-07-02 20:19:36.13557+00&#39;&#34;</span></code></pre></div>
<h4 id="tracking-a-newly-provisioned-cluster">Tracking a Newly Provisioned Cluster</h4>

<p>A new PostgreSQL cluster can take a few moments to provision. You may have
noticed that the <code>pgo create cluster</code> command returns something called a
&ldquo;workflow id&rdquo;. This workflow ID allows you to track the progress of your new
PostgreSQL cluster while it is being provisioned using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_workflow/"><code>pgo show workflow</code></a>
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show workflow ae714d12-f5d0-4fa9-910f-21944b41dec8</code></pre></div>
<p>which can yield output similar to:</p>

<pre><code>parameter           value
---------           -----
pg-cluster          hacluster
task completed      2019-12-27T02:10:14Z
task submitted      2019-12-27T02:09:46Z
workflowid          ae714d12-f5d0-4fa9-910f-21944b41dec8
</code></pre>

<h3 id="view-postgresql-cluster-details">View PostgreSQL Cluster Details</h3>

<p>To see details about your PostgreSQL cluster, you can use the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_cluster/"><code>pgo show cluster</code></a>
command. These details include elements such as:</p>

<ul>
<li>The version of PostgreSQL that the cluster is using</li>
<li>The PostgreSQL instances that comprise the cluster</li>
<li>The Pods assigned to the cluster for all of the associated components,
including the nodes that the pods are assigned to</li>
<li>The Persistent Volume Claims (PVC) that are being consumed by the cluster</li>
<li>The Kubernetes Deployments associated with the cluster</li>
<li>The Kubernetes Services associated with the cluster</li>
<li>The Kubernetes Labels that are assigned to the PostgreSQL instances</li>
</ul>

<p>and more.</p>

<p>You can view the details of the cluster by executing the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show cluster hacluster</code></pre></div>
<p>which will yield output similar to:</p>

<pre><code>cluster : hacluster (crunchy-postgres-ha:centos7-12.6-4.4.3)
	pod : hacluster-6dc6cfcfb9-f9knq (Running) on node01 (1/1) (primary)
	pvc : hacluster
	resources : CPU Limit= Memory Limit=, CPU Request= Memory Request=
	storage : Primary=200M Replica=200M
	deployment : hacluster
	deployment : hacluster-backrest-shared-repo
	service : hacluster - ClusterIP (10.102.20.42)
	labels : pg-pod-anti-affinity= archive-timeout=60 crunchy-pgbadger=false crunchy_collect=false deployment-name=hacluster pg-cluster=hacluster crunchy-pgha-scope=hacluster autofail=true pgo-backrest=true pgo-version=4.4.3 current-primary=hacluster name=hacluster pgouser=admin workflowid=ae714d12-f5d0-4fa9-910f-21944b41dec8
</code></pre>

<h3 id="deleting-a-cluster">Deleting a Cluster</h3>

<p>You can delete a PostgreSQL cluster that is managed by the PostgreSQL Operator
by executing the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo delete cluster hacluster</code></pre></div>
<p>This will remove the cluster from being managed by the PostgreSQL Operator, as
well as delete the root data Persistent Volume Claim (PVC) and backup PVCs
associated with the cluster.</p>

<p>If you wish to keep your PostgreSQL data PVC, you can delete the cluster with
the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo delete cluster hacluster --keep-data</code></pre></div>
<p>You can then recreate the PostgreSQL cluster with the same data by using the
<code>pgo create cluster</code> command with a cluster of the same name:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster</code></pre></div>
<p>This technique is used when performing tasks such as upgrading the PostgreSQL
Operator.</p>

<p>You can also keep the pgBackRest repository associated with the PostgreSQL
cluster by using the <code>--keep-backups</code> flag with the <code>pgo delete cluster</code>
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo delete cluster hacluster --keep-backups</code></pre></div>
<h2 id="testing-postgresql-cluster-availability">Testing PostgreSQL Cluster Availability</h2>

<p>You can test the availability of your cluster by using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_test/"><code>pgo test</code></a>
command. The <code>pgo test</code> command checks to see if the Kubernetes Services and
the Pods that comprise the PostgreSQL cluster are available to receive
connections. This includes:</p>

<ul>
<li>Testing that the Kubernetes Endpoints are available and able to route requests
to healthy Pods</li>
<li>Testing that each PostgreSQL instance is available and ready to accept client
connections by performing a connectivity check similar to the one performed by
<code>pg_isready</code></li>
</ul>

<p>To test the availability of a PostgreSQL cluster, you can run the following
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo <span style="color:#111">test</span> hacluster</code></pre></div>
<p>which will yield output similar to:</p>

<pre><code>cluster : hacluster
	Services
		primary (10.102.20.42:5432): UP
	Instances
		primary (hacluster-6dc6cfcfb9-f9knq): UP
</code></pre>

<h2 id="disaster-recovery-backups-restores">Disaster Recovery: Backups &amp; Restores</h2>

<p>The PostgreSQL Operator supports sophisticated functionality for managing your
backups and restores. For more information for how this works, please see the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/disaster-recovery/">disaster recovery</a> guide.</p>

<h3 id="creating-a-backup">Creating a Backup</h3>

<p>The PostgreSQL Operator uses the open source <a href="https://www.pgbackrest.org">pgBackRest</a>
backup and recovery utility for managing backups and PostgreSQL archives. These
backups are also used as part of managing the overall health and
high-availability of PostgreSQL clusters managed by the PostgreSQL Operator and
used as part of the cloning process as well.</p>

<p>When a new PostgreSQL cluster is provisioned by the PostgreSQL Operator, a full
pgBackRest backup is taken by default. This is required in order to create new
replicas (via <code>pgo scale</code>) for the PostgreSQL cluster as well as healing during
a <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/">failover scenario</a>.</p>

<p>To create a backup, you can run the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster</code></pre></div>
<p>which by default, will create an incremental pgBackRest backup. The reason for
this is that the PostgreSQL Operator initially creates a pgBackRest full backup
when the cluster is initial provisioned, and pgBackRest will take incremental
backups for each subsequent backup until a different backup type is specified.</p>

<p>Most pgBackRest options are supported and can be passed in by the PostgreSQL
Operator via the <code>--backup-opts</code> flag. What follows are some examples for how
to utilize pgBackRest with the PostgreSQL Operator to help you create your
optimal disaster recovery setup.</p>

<h4 id="creating-a-full-backup">Creating a Full Backup</h4>

<p>You can create a full backup using the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--type=full&#34;</span></code></pre></div>
<h4 id="creating-a-differential-backup">Creating a Differential Backup</h4>

<p>You can create a differential backup using the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--type=diff&#34;</span></code></pre></div>
<h4 id="creating-an-incremental-backup">Creating an Incremental Backup</h4>

<p>You can create a differential backup using the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--type=incr&#34;</span></code></pre></div>
<p>An incremental backup is created without specifying any options after a full or
differential backup is taken.</p>

<h3 id="creating-backups-in-s3">Creating Backups in S3</h3>

<p>The PostgreSQL Operator supports creating backups in S3 or any object storage
system that uses the S3 protocol. For more information, please read the section
on <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/disaster-recovery/#using-s3">PostgreSQL Operator Backups with S3</a>
in the architecture section.</p>

<h3 id="displaying-backup-information">Displaying Backup Information</h3>

<p>You can see information about the current state of backups in a PostgreSQL
cluster managed by the PostgreSQL Operator by executing the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show backup hacluster</code></pre></div>
<h3 id="setting-backup-retention">Setting Backup Retention</h3>

<p>By default, pgBackRest will allow you to keep on creating backups until you run
out of disk space. As such, it may be helpful to manage how many backups are
retained.</p>

<p>pgBackRest comes with several flags for managing how backups can be retained:</p>

<ul>
<li><code>--repo1-retention-full</code>: how many full backups to retain</li>
<li><code>--repo1-retention-diff</code>: how many differential backups to retain</li>
<li><code>--repo1-retention-archive</code>: how many sets of WAL archives to retain alongside
the full and differential backups that are retained</li>
</ul>

<p>For example, to create a full backup and retain the previous 7 full backups, you
would execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--type=full --repo1-retention-full=7&#34;</span></code></pre></div>
<h3 id="scheduling-backups">Scheduling Backups</h3>

<p>Any effective disaster recovery strategy includes having regularly scheduled
backups. The PostgreSQL Operator enables this through its scheduling sidecar
that is deployed alongside the Operator.</p>

<h4 id="creating-a-scheduled-backup">Creating a Scheduled Backup</h4>

<p>For example, to schedule a full backup once a day at midnight, you can execute
the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create schedule hacluster --schedule<span style="color:#f92672">=</span><span style="color:#d88200">&#34;0 1 * * *&#34;</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --schedule-type<span style="color:#f92672">=</span>pgbackrest  --pgbackrest-backup-type<span style="color:#f92672">=</span>full</code></pre></div>
<p>To schedule an incremental backup once every 3 hours, you can execute the
following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create schedule hacluster --schedule<span style="color:#f92672">=</span><span style="color:#d88200">&#34;0 */3 * * *&#34;</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --schedule-type<span style="color:#f92672">=</span>pgbackrest  --pgbackrest-backup-type<span style="color:#f92672">=</span>incr</code></pre></div>
<p>You can also create regularly scheduled backups and combine it with a retention
policy. For example, using the above example of taking a nightly full backup,
you can specify a policy of retaining 21 backups by executing the following
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create schedule hacluster --schedule<span style="color:#f92672">=</span><span style="color:#d88200">&#34;0 0 * * *&#34;</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --schedule-type<span style="color:#f92672">=</span>pgbackrest  --pgbackrest-backup-type<span style="color:#f92672">=</span>full <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --schedule-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--repo1-retention-full=21&#34;</span></code></pre></div>
<h3 id="restore-a-cluster">Restore a Cluster</h3>

<p>The PostgreSQL Operator supports the ability to perform a full restore on a
PostgreSQL cluster (i.e. a &ldquo;clone&rdquo; or &ldquo;copy&rdquo;) as well as a
point-in-time-recovery. There are two types of ways to restore a cluster:</p>

<ul>
<li>Restore to a new cluster using the <code>--restore-from</code> flag in the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/"><code>pgo create cluster</code></a>
command. This is effectively a <a href="#clone-a-postgresql-cluster">clone</a> or a copy.</li>
<li>Restore in-place using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_restore/"><code>pgo restore</code></a>
command. Note that this is <strong>destructive</strong>.</li>
</ul>

<p>It is typically better to perform a restore to a new cluster, particularly when
performing a point-in-time-recovery, as it can allow you to more effectively
manage your downtime and avoid making undesired changes to your production data.</p>

<p>Additionally, the &ldquo;restore to a new cluster&rdquo; technique works so long as you have
a pgBackRest repository available: the pgBackRest repository does not need to be
attached to an active cluster! For example, if a cluster named <code>hippo</code> was
deleted as such:</p>

<pre><code>pgo delete cluster hippo --keep-backups
</code></pre>

<p>you can create a new cluster from the backups like so:</p>

<pre><code>pgo create cluster datalake --restore-from=hippo
</code></pre>

<p>Below provides guidance on how to perform a restore to a new PostgreSQL cluster
both as a full copy and to a specific point in time. Additionally, it also
shows how to restore in place to a specific point in time.</p>

<h4 id="restore-to-a-new-cluster-aka-copy-or-clone">Restore to a New Cluster (aka &ldquo;copy&rdquo; or &ldquo;clone&rdquo;)</h4>

<p>Restoring to a new PostgreSQL cluster allows one to take a backup and create a
new PostgreSQL cluster that can run alongside an existing PostgreSQL cluster.
There are several scenarios where using this technique is helpful:</p>

<ul>
<li>Creating a copy of a PostgreSQL cluster that can be used for other purposes.
Another way of putting this is &ldquo;creating a clone.&rdquo;</li>
<li>Restore to a point-in-time and inspect the state of the data without affecting
the current cluster</li>
</ul>

<p>and more.</p>

<h5 id="full-restore">Full Restore</h5>

<p>To create a new PostgreSQL cluster from a backup and restore it fully, you can
execute the following command:</p>

<pre><code>pgo create cluster newcluster --restore-from=oldcluster
</code></pre>

<h5 id="point-in-time-recovery-pitr">Point-in-time-Recovery (PITR)</h5>

<p>To create a new PostgreSQL cluster and restore it to specific point-in-time
(e.g. before a key table was dropped), you can use the following command,
substituting the time that you wish to restore to:</p>

<pre><code>pgo create cluster newcluster \
  --restore-from oldcluster \
  --restore-opts &quot;--type=time --target='2019-12-31 11:59:59.999999+00'&quot;
</code></pre>

<p>When the restore is complete, the cluster is immediately available for reads and
writes. To inspect the data before allowing connections, add pgBackRest&rsquo;s
<code>--target-action=pause</code> option to the <code>--restore-opts</code> parameter.</p>

<p>The PostgreSQL Operator supports the full set of pgBackRest restore options,
which can be passed into the <code>--backup-opts</code> parameter. For more information,
please review the <a href="https://pgbackrest.org/command.html#command-restore">pgBackRest restore options</a></p>

<h4 id="restore-in-place">Restore in-place</h4>

<p>Restoring a PostgreSQL cluster in-place is a <strong>destructive</strong> action that will
perform a recovery on your existing data directory. This is accomplished using
the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_restore/"><code>pgo restore</code></a>
command. The most common scenario is to restore the database to a specific point
in time.</p>

<h5 id="point-in-time-recovery-pitr-1">Point-in-time-Recovery (PITR)</h5>

<p>The more likely scenario when performing a PostgreSQL cluster restore is to
recover to a particular point-in-time (e.g. before a key table was dropped). For
example, to restore a cluster to December 31, 2019 at 11:59pm:</p>

<pre><code>pgo restore hacluster --pitr-target=&quot;2019-12-31 11:59:59.999999+00&quot; \
  --backup-opts=&quot;--type=time&quot;
</code></pre>

<p>When the restore is complete, the cluster is immediately available for reads and
writes. To inspect the data before allowing connections, add pgBackRest&rsquo;s
<code>--target-action=pause</code> option to the <code>--backup-opts</code> parameter.</p>

<p>The PostgreSQL Operator supports the full set of pgBackRest restore options,
which can be passed into the <code>--backup-opts</code> parameter. For more information,
please review the <a href="https://pgbackrest.org/command.html#command-restore">pgBackRest restore options</a></p>

<p>Using this technique, after a restore is complete, you will need to re-enable
high availability on the PostgreSQL cluster manually. You can re-enable high
availability by executing the following command:</p>

<pre><code>pgo update cluster hacluster --enable-autofail
</code></pre>

<h3 id="logical-backups-pg-dump-pg-dumpall">Logical Backups (<code>pg_dump</code> / <code>pg_dumpall</code>)</h3>

<p>The PostgreSQL Operator supports taking logical backups with <code>pg_dump</code> and
<code>pg_dumpall</code>. While they do not provide the same performance and storage
optimizations as the physical backups provided by pgBackRest, logical backups
are helpful when one wants to upgrade between major PostgreSQL versions, or
provide only a subset of a database, such as a table.</p>

<h4 id="create-a-logical-backup">Create a Logical Backup</h4>

<p>To create a logical backup of the &lsquo;postgres&rsquo; database, you can run the following
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-type<span style="color:#f92672">=</span>pgdump</code></pre></div>
<p>To create a logical backup of a specific database, you can use the <code>--database</code> flag,
as in the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-type<span style="color:#f92672">=</span>pgdump --database<span style="color:#f92672">=</span>mydb</code></pre></div>
<p>You can pass in specific options to <code>--backup-opts</code>, which can accept most of
the options that the <a href="https://www.postgresql.org/docs/current/app-pgdump.html"><code>pg_dump</code></a>
command accepts. For example, to only dump the data from a specific table called
<code>users</code>:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-type<span style="color:#f92672">=</span>pgdump --backup-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;-t users&#34;</span></code></pre></div>
<p>To use <code>pg_dumpall</code> to create a logical backup of all the data in a PostgreSQL
cluster, you must pass the <code>--dump-all</code> flag in <code>--backup-opts</code>, i.e.:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo backup hacluster --backup-type<span style="color:#f92672">=</span>pgdump --backup-opts<span style="color:#f92672">=</span><span style="color:#d88200">&#34;--dump-all&#34;</span></code></pre></div>
<h4 id="viewing-logical-backups">Viewing Logical Backups</h4>

<p>To view an available list of logical backups, you can use the <code>pgo show backup</code>
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show backup --backup-type<span style="color:#f92672">=</span>pgdump</code></pre></div>
<p>This provides information about the PVC that the logical backups are stored on
as well as the timestamps required to perform a restore from a logical backup.</p>

<h4 id="restore-from-a-logical-backup">Restore from a Logical Backup</h4>

<p>To restore from a logical backup, you need to reference the PVC that the logical
backup is stored to, as well as the timestamp that was created by the logical
backup.</p>

<p>You can restore a logical backup using the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo restore hacluster --backup-type<span style="color:#f92672">=</span>pgdump --backup-pvc<span style="color:#f92672">=</span>hacluster-pgdump-pvc <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pitr-target<span style="color:#f92672">=</span><span style="color:#d88200">&#34;2019-01-15-00-03-25&#34;</span> -n pgouser1</code></pre></div>
<p>To restore to a specific database, add the <code>--pgdump-database</code> flag to the
command from above:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo restore hacluster --backup-type<span style="color:#f92672">=</span>pgdump --backup-pvc<span style="color:#f92672">=</span>hacluster-pgdump-pvc <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgdump-database<span style="color:#f92672">=</span>mydb --pitr-target<span style="color:#f92672">=</span><span style="color:#d88200">&#34;2019-01-15-00-03-25&#34;</span> -n pgouser1</code></pre></div>
<h2 id="high-availability-scaling-up-down">High-Availability: Scaling Up &amp; Down</h2>

<p>The PostgreSQL Operator supports a robust <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability">high-availability</a>
set up to ensure that your PostgreSQL clusters can stay up and running. For
detailed information on how it works, please see the
<a href="(/architecture/high-availability)">high-availability architecture</a> section.</p>

<h3 id="creating-a-new-replica">Creating a New Replica</h3>

<p>To create a new replica, also known as &ldquo;scaling up&rdquo;, you can execute the
following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo scale hacluster --replica-count<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span></code></pre></div>
<p>If you wanted to add two new replicas at the same time, you could execute the
following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo scale hacluster --replica-count<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span></code></pre></div>
<h3 id="viewing-available-replicas">Viewing Available Replicas</h3>

<p>You can view the available replicas in a few ways. First, you can use <code>pgo show cluster</code>
to see the overall information about the PostgreSQL cluster:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo show cluster hacluster</code></pre></div>
<p>You can also find specific replica names by using the <code>--query</code> flag on the
<code>pgo failover</code> and <code>pgo scaledown</code> commands, e.g.:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo failover --query hacluster</code></pre></div>
<h3 id="manual-failover">Manual Failover</h3>

<p>The PostgreSQL Operator is set up with an automated failover system based on
distributed consensus, but there may be times where you wish to have your
cluster manually failover. If you wish to have your cluster manually failover,
first, query your cluster to determine which failover targets are available.
The query command also provides information that may help your decision, such as
replication lag:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo failover --query hacluster</code></pre></div>
<p>Once you have selected the replica that is best for your to failover to, you can
perform a failover with the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo failover hacluster --target<span style="color:#f92672">=</span>hacluster-abcd</code></pre></div>
<p>where <code>hacluster-abcd</code> is the name of the PostgreSQL instance that you want to
promote to become the new primary</p>

<h4 id="destroying-a-replica">Destroying a Replica</h4>

<p>To destroy a replica, first query the available replicas by using the <code>--query</code>
flag on the <code>pgo scaledown</code> command, i.e.:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo scaledown hacluster --query</code></pre></div>
<p>Once you have picked the replica you want to remove, you can remove it by
executing the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo scaledown hacluster --target<span style="color:#f92672">=</span>hacluster-abcd</code></pre></div>
<p>where <code>hacluster-abcd</code> is the name of the PostgreSQL replica that you want to
destroy.</p>

<h2 id="cluster-maintenance-resource-management">Cluster Maintenance &amp; Resource Management</h2>

<p>There are several operations that you can perform to modify a PostgreSQL cluster
over its lifetime.</p>

<h4 id="modify-cpu-memory-for-a-postgresql-cluster">Modify CPU / Memory for a PostgreSQL Cluster</h4>

<p>As database workloads change, it may be necessary to modify the CPU and memory
allocation for your PostgreSQL cluster. The PostgreSQL Operator allows for this
via the <code>--cpu</code> and <code>--memory</code> flags on the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_cluster/"><code>pgo update cluster</code></a>
command. Similar to the create command, both flags accept values that follow the
<a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/">Kubernetes quantity format</a>.</p>

<p>For example, to update a PostgreSQL cluster to use 8 CPU cores and has 32
gibibytes of memory, you can use the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo update cluster hacluster --cpu<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span> --memory<span style="color:#f92672">=</span>32Gi</code></pre></div>
<p>The resource allocations apply to all instances in a PostgreSQL cluster: this
means your primary and any replicas will have the same cluster resource
allocations. Be sure to specify resource requests that your Kubernetes
environment can support.</p>

<p><strong>NOTE</strong>: This operation can cause downtime. Modifying the resource requests
allocated to a Deployment requires that the Pods in a Deployment must be
restarted. Each PostgreSQL instance is safely shutdown using the <a href="https://www.postgresql.org/docs/current/app-pg-ctl.html">&ldquo;fast&rdquo;</a>
shutdown method to help ensure it will not enter crash recovery mode when a new
Pod is created.</p>

<p>When the operation completes, each PostgreSQL instance will have the new
resource allocations.</p>

<h4 id="adding-a-tablespace-to-a-cluster">Adding a Tablespace to a Cluster</h4>

<p>Based on your workload or volume of data, you may wish to add a
<a href="https://www.postgresql.org/docs/current/manage-ag-tablespaces.html">tablespace</a> to
your PostgreSQL cluster.</p>

<p>You can add a tablespace to an existing PostgreSQL cluster with the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_cluster/"><code>pgo update cluster</code></a> command.
Adding a tablespace to a cluster uses a similar syntax to
<a href="#create-a-postgresql-cluster-with-a-tablespace">creating a cluster with a tablespace</a>, for example:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo update cluster hacluster <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    --tablespace<span style="color:#f92672">=</span><span style="color:#111">name</span><span style="color:#f92672">=</span>tablespace3:storageconfig<span style="color:#f92672">=</span>storageconfigname</code></pre></div>
<p><strong>NOTE</strong>: This operation can cause downtime. In order to add a tablespace to a
PostgreSQL cluster, persistent volume claims (PVCs) need to be created and
mounted to each PostgreSQL instance in the cluster. The act of mounting a new
PVC to a Kubernetes Deployment causes the Pods in the deployment to restart.</p>

<p>Each PostgreSQL instance is safely shutdown using the <a href="https://www.postgresql.org/docs/current/app-pg-ctl.html">&ldquo;fast&rdquo;</a>
shutdown method to help ensure it will not enter crash recovery mode when a new
Pod is created.</p>

<p>When the operation completes, the tablespace will be set up and accessible to
use within the PostgreSQL cluster.</p>

<p>For more information on tablespaces, please visit the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/tablespaces/">tablespace</a>
section of the documentation.</p>

<h2 id="clone-a-postgresql-cluster">Clone a PostgreSQL Cluster</h2>

<p>You can create a copy of an existing PostgreSQL cluster in a new PostgreSQL
cluster by using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/"><code>pgo create cluster</code></a>
command with the <code>--restore-from</code> flag (and, if needed, <code>--restore-opts</code>).
The command copies the pgBackRest repository from either an active PostgreSQL
cluster, or a pgBackRest repository that exists from a former cluster that was
deleted using <code>pgo delete cluster --keep-backups</code>.</p>

<p>You can clone a PostgreSQL cluster by running the following command:</p>

<pre><code>pgo clone hacluster newhacluster
</code></pre>

<p>By leveraging <code>pgo create cluster</code>, you are able to copy the data from a
PostgreSQL cluster while creating the topology of a new cluster the way you want
to. For instance, if you want to copy data from an existing cluster that does
not have metrics to a new cluster that does, you can accomplish that with the
following command:</p>

<pre><code>pgo create cluster newcluster --restore-from=oldcluster --metrics
</code></pre>

<h3 id="clone-a-postgresql-cluster-to-different-pvc-size">Clone a PostgreSQL Cluster to Different PVC Size</h3>

<p>You can have a cloned PostgreSQL cluster use a different PVC size, which is
useful when moving your PostgreSQL cluster to a larger PVC. For example, to
clone a PostgreSQL cluster to a 256GiB PVC, you can execute the following
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster bighippo --restore-from<span style="color:#f92672">=</span>hippo  --pvc-size<span style="color:#f92672">=</span>256Gi</code></pre></div>
<p>You can also have the cloned PostgreSQL cluster use a larger pgBackRest
backup repository by setting its PVC size. For example, to have a cloned
PostgreSQL cluster use a 1TiB pgBackRest repository, you can execute the
following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster bighippo --restore-from<span style="color:#f92672">=</span>hippo --pgbackrest-pvc-size<span style="color:#f92672">=</span>1Ti</code></pre></div>
<h2 id="enable-tls">Enable TLS</h2>

<p>TLS allows secure TCP connections to PostgreSQL, and the PostgreSQL Operator
makes it easy to enable this PostgreSQL feature. The TLS support in the
PostgreSQL Operator does not make an opinion about your PKI, but rather loads in
your TLS key pair that you wish to use for the PostgreSQL server as well as its
corresponding certificate authority (CA) certificate. Both of these Secrets are
required to enable TLS support for your PostgreSQL cluster when using the
PostgreSQL Operator, but it in turn allows seamless TLS support.</p>

<h3 id="setup">Setup</h3>

<p>There are three items that are required to enable TLS in your PostgreSQL
clusters:</p>

<ul>
<li>A CA certificate</li>
<li>A TLS private key</li>
<li>A TLS certificate</li>
</ul>

<p>There are a variety of methods available to generate these items: in fact,
Kubernetes comes with its own <a href="https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/">certificate management system</a>!
It is up to you to decide how you want to manage this for your cluster. The
PostgreSQL documentation also provides an example for how to
<a href="https://www.postgresql.org/docs/current/ssl-tcp.html#SSL-CERTIFICATE-CREATION">generate a TLS certificate</a>
as well.</p>

<p>To set up TLS for your PostgreSQL cluster, you have to create two <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Secrets</a>:
one that contains the CA certificate, and the other that contains the server
TLS key pair.</p>

<p>First, create the Secret that contains your CA certificate. Create the Secret
as a generic Secret, and note that the following requirements <strong>must</strong> be met:</p>

<ul>
<li>The Secret must be created in the same Namespace as where you are deploying
your PostgreSQL cluster</li>
<li>The <code>name</code> of the key that is holding the CA <strong>must</strong> be <code>ca.crt</code></li>
</ul>

<p>There are optional settings for setting up the CA secret:</p>

<ul>
<li>You can pass in a certificate revocation list (CRL) for the CA secret by
passing in the CRL using the <code>ca.crl</code> key name in the Secret.</li>
</ul>

<p>For example, to create a CA Secret with the trusted CA to use for the PostgreSQL
clusters, you could execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret generic postgresql-ca --from-file<span style="color:#f92672">=</span>ca.crt<span style="color:#f92672">=</span>/path/to/ca.crt</code></pre></div>
<p>To create a CA Secret that includes a CRL, you could execute the following
command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret generic postgresql-ca <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --from-file<span style="color:#f92672">=</span>ca.crt<span style="color:#f92672">=</span>/path/to/ca.crt <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --from-file<span style="color:#f92672">=</span>ca.crl<span style="color:#f92672">=</span>/path/to/ca.crl</code></pre></div>
<p>Note that you can reuse this CA Secret for other PostgreSQL clusters deployed by
the PostgreSQL Operator.</p>

<p>Next, create the Secret that contains your TLS key pair. Create the Secret as a
a TLS Secret, and note the following requirement must be met:</p>

<ul>
<li>The Secret must be created in the same Namespace as where you are deploying
your PostgreSQL cluster</li>
</ul>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret tls hacluster-tls-keypair <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --cert<span style="color:#f92672">=</span>/path/to/server.crt <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --key<span style="color:#f92672">=</span>/path/to/server.key</code></pre></div>
<p>Now you can create a TLS-enabled PostgreSQL cluster!</p>

<h3 id="create-a-tls-enabled-postgresql-cluster">Create a TLS Enabled PostgreSQL Cluster</h3>

<p>Using the above example, to create a TLS-enabled PostgreSQL cluster that can
accept both TLS and non-TLS connections, execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster-tls <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --server-ca-secret<span style="color:#f92672">=</span>postgresql-ca <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --server-tls-secret<span style="color:#f92672">=</span>hacluster-tls-keypair</code></pre></div>
<p>Including the <code>--server-ca-secret</code> and <code>--server-tls-secret</code> flags automatically
enable TLS connections in the PostgreSQL cluster that is deployed. These flags
should reference the CA Secret and the TLS key pair Secret, respectively.</p>

<p>If deployed successfully, when you connect to the PostgreSQL cluster, assuming
your <code>PGSSLMODE</code> is set to <code>prefer</code> or higher, you will see something like this
in your <code>psql</code> terminal:</p>

<pre><code>SSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-GCM-SHA384, bits: 256, compression: off)
</code></pre>

<h3 id="force-tls-in-a-postgresql-cluster">Force TLS in a PostgreSQL Cluster</h3>

<p>There are many environments where you want to force all remote connections to
occur over TLS, for example, if you deploy your PostgreSQL cluster&rsquo;s in a public
cloud or on an untrusted network. The PostgreSQL Operator lets you force all
remote connections to occur over TLS by using the <code>--tls-only</code> flag.</p>

<p>For example, using the setup above, you can force TLS in a PostgreSQL cluster by
executing the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hacluster-tls-only <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --tls-only <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --server-ca-secret<span style="color:#f92672">=</span>hacluster-tls-keypair --server-tls-secret<span style="color:#f92672">=</span>postgresql-ca</code></pre></div>
<p>If deployed successfully, when you connect to the PostgreSQL cluster, assuming
your <code>PGSSLMODE</code> is set to <code>prefer</code> or higher, you will see something like this
in your <code>psql</code> terminal:</p>

<pre><code>SSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-GCM-SHA384, bits: 256, compression: off)
</code></pre>

<p>If you try to connect to a PostgreSQL cluster that is deployed using the
<code>--tls-only</code> with TLS disabled (i.e. <code>PGSSLMODE=disable</code>), you will receive an
error that connections without TLS are unsupported.</p>

<h3 id="tls-authentication-for-postgresql-replication">TLS Authentication for PostgreSQL Replication</h3>

<p>PostgreSQL supports <a href="https://www.postgresql.org/docs/current/auth-cert.html">certificate-based authentication</a>,
which allows for PostgreSQL to authenticate users based on the common name (CN)
in a certificate. Using this feature, the PostgreSQL Operator allows you to
configure PostgreSQL replicas in a cluster to authenticate using a certificate
instead of a password.</p>

<p>To use this feature, first you will need to set up a Kubernetes TLS Secret that
has a CN of <code>primaryuser</code>. If you do not wish to have this as your CN, you will
need to map the CN of this certificate to the value of <code>primaryuser</code> using a
<a href="https://www.postgresql.org/docs/current/auth-username-maps.html">pg_ident</a>
username map, which you can configure as part of a
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/">custom PostgreSQL configuration</a>.</p>

<p>You also need to ensure that the certificate is verifiable by the certificate
authority (CA) chain that you have provided for your PostgreSQL cluster. The CA
is provided as part of the <code>--server-ca-secret</code> flag in the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_cluster/"><code>pgo create cluster</code></a>
command.</p>

<p>To create a PostgreSQL cluster that uses TLS authentication for replication,
first create Kubernetes Secrets for the server and the CA. For the purposes of
this example, we will use the ones that were created earlier: <code>postgresql-ca</code>
and <code>hacluster-tls-keypair</code>. After generating a certificate that has a CN of
<code>primaryuser</code>, create a Kubernetes Secret that references this TLS keypair
called <code>hacluster-tls-replication-keypair</code>:</p>

<pre><code>kubectl create secret tls hacluster-tls-replication-keypair \
  --cert=/path/to/replication.crt \
  --key=/path/to/replication.key
</code></pre>

<p>We can now create a PostgreSQL cluster and allow for it to use TLS
authentication for its replicas! Let&rsquo;s create a PostgreSQL cluster with two
replicas that also requires TLS for any connection:</p>

<pre><code>pgo create cluster hippo \
  --tls-only \
  --server-ca-secret=postgresql-ca \
  --server-tls-secret=hacluster-tls-keypair \
  --replication-tls-secret=hacluster-tls-replication-keypair \
  --replica-count=2
</code></pre>

<p>By default, the PostgreSQL Operator has each replica connect to PostgreSQL using
a <a href="https://www.postgresql.org/docs/current/libpq-ssl.html#LIBPQ-SSL-SSLMODE-STATEMENTS">PostgreSQL TLS mode</a>
of <code>verify-ca</code>. If you wish to perform TLS mutual authentication between
PostgreSQL instances (i.e. certificate-based authentication with SSL mode of
<code>verify-full</code>), you will need to create a
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/">PostgreSQL custom configuration</a>.</p>

<h2 id="custom-postgresql-configuration-hahahugoshortcode-s32-hbhb"><a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/">Custom PostgreSQL Configuration</a></h2>

<p>Customizing PostgreSQL configuration is currently not subject to the <code>pgo</code>
client, but given it is a common question, we thought it may be helpful to link
to how to do it from here. To find out more about how to
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/">customize your PostgreSQL configuration</a>,
please refer to the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/advanced/custom-configuration/">Custom PostgreSQL Configuration</a>
section of the documentation.</p>

<h2 id="pgadmin-4-postgresql-administration">pgAdmin 4: PostgreSQL Administration</h2>

<p><a href="https://www.pgadmin.org/">pgAdmin 4</a> is a popular graphical user interface that
lets you work with PostgreSQL databases from both a desktop or web-based client.
In the case of the PostgreSQL Operator, the pgAdmin 4 web client can be deployed
and synchronized with PostgreSQL clusters so that users can administrate their
databases with their PostgreSQL username and password.</p>

<p>For example, let&rsquo;s work with a PostgreSQL cluster called <code>hippo</code> that has a user named <code>hippo</code> with password <code>datalake</code>, e.g.:</p>

<pre><code>pgo create cluster hippo --username=hippo --password=datalake
</code></pre>

<p>Once the <code>hippo</code> PostgreSQL cluster is ready, create the pgAdmin 4 deployment
with the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_create_pgadmin/"><code>pgo create pgadmin</code></a>
command:</p>

<pre><code>pgo create pgadmin hippo
</code></pre>

<p>This creates a pgAdmin 4 deployment unique to this PostgreSQL cluster and
synchronizes the PostgreSQL user information into it. To access pgAdmin 4, you
can set up a port-forward to the Service, which follows the
pattern <code>&lt;clusterName&gt;-pgadmin</code>, to port <code>5050</code>:</p>

<pre><code>kubectl port-forward svc/hippo-pgadmin 5050:5050
</code></pre>

<p>Point your browser at <code>http://localhost:5050</code> and use your database username
(e.g. <code>hippo</code>) and password (e.g. <code>datalake</code>) to log in.</p>

<p><img src="https://crunchydata.github.io/postgres-operator/4.4.3/images/pgadmin4-login.png" alt="pgAdmin 4 Login Page" /></p>

<p>(Note: if your password does not appear to work, you can retry setting up the
user with the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_update_user/"><code>pgo update user</code></a>
command: <code>pgo update user hippo --password=datalake</code>)</p>

<p>The <code>pgo create user</code>, <code>pgo update user</code>, and <code>pgo delete user</code> commands are
synchronized with the pgAdmin 4 deployment. Any user with credentials to this
PostgreSQL cluster will be able to log in and use pgAdmin 4:</p>

<p><img src="https://crunchydata.github.io/postgres-operator/4.4.3/images/pgadmin4-query.png" alt="pgAdmin 4 Query" /></p>

<p>You can remove the pgAdmin 4 deployment with the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_delete_pgadmin/"><code>pgo delete pgadmin</code></a>
command.</p>

<p>For more information, please read the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/pgadmin4/">pgAdmin 4 Architecture</a>
section of the documentation.</p>

<h2 id="standby-clusters-multi-cluster-kubernetes-deployments">Standby Clusters: Multi-Cluster Kubernetes Deployments</h2>

<p>A <a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/multi-cluster-kubernetes/">standby PostgreSQL cluster</a>
can be used to create an advanced high-availability set with a PostgreSQL
cluster running in a different Kubernetes cluster, or used for other operations
such as migrating from one PostgreSQL cluster to another. Note: this is not
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/">high availability</a>
per se: a high-availability PostgreSQL cluster will automatically fail over upon
a downtime event, whereas a standby PostgreSQL cluster must be explicitly
promoted.</p>

<p>With that said, you can run multiple PostgreSQL Operators in different
Kubernetes clusters, and the below functionality will work!</p>

<p>Below are some commands for setting up and using standby PostgreSQL clusters.
For more details on how standby clusters work, please review the section on
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/architecture/high-availability/multi-cluster-kubernetes/">Kubernetes Multi-Cluster Deployments</a>.</p>

<h3 id="creating-a-standby-cluster">Creating a Standby Cluster</h3>

<p>Before creating a standby cluster, you will need to ensure that your primary
cluster is created properly. Standby clusters require the use of S3 or
equivalent S3-compatible storage system that is accessible to both the primary
and standby clusters. For example, to create a primary cluster to these
specifications:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hippo --pgbouncer --replica-count<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-storage-type<span style="color:#f92672">=</span>local,s3 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-key<span style="color:#f92672">=</span>&lt;redacted&gt; <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-key-secret<span style="color:#f92672">=</span>&lt;redacted&gt; <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-bucket<span style="color:#f92672">=</span>watering-hole <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-endpoint<span style="color:#f92672">=</span>s3.amazonaws.com <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-region<span style="color:#f92672">=</span>us-east-1 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-uri-style<span style="color:#f92672">=</span>host <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-verify-tls<span style="color:#f92672">=</span><span style="color:#111">true</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --password-superuser<span style="color:#f92672">=</span>supersecrethippo <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --password-replication<span style="color:#f92672">=</span>somewhatsecrethippo <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --password<span style="color:#f92672">=</span>opensourcehippo</code></pre></div>
<p>Before setting up the standby PostgreSQL cluster, you will need to wait a few
moments for the primary PostgreSQL cluster to be ready. Once your primary
PostgreSQL cluster is available, you can create a standby cluster by using the
following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo create cluster hippo-standby --standby --replica-count<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-storage-type<span style="color:#f92672">=</span>s3 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-key<span style="color:#f92672">=</span>&lt;redacted&gt; <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-key-secret<span style="color:#f92672">=</span>&lt;redacted&gt; <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-bucket<span style="color:#f92672">=</span>watering-hole <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-endpoint<span style="color:#f92672">=</span>s3.amazonaws.com <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-region<span style="color:#f92672">=</span>us-east-1 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-uri-style<span style="color:#f92672">=</span>host <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-s3-verify-tls<span style="color:#f92672">=</span><span style="color:#111">true</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --pgbackrest-repo-path<span style="color:#f92672">=</span>/backrestrepo/hippo-backrest-shared-repo <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --password-superuser<span style="color:#f92672">=</span>supersecrethippo <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --password-replication<span style="color:#f92672">=</span>somewhatsecrethippo <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  --password<span style="color:#f92672">=</span>opensourcehippo</code></pre></div>
<p>If you are unsure of your user credentials form the original <code>hippo</code> cluster,
you can retrieve them using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_user/"><code>pgo show user</code></a>
command with the <code>--show-system-accounts</code> flag:</p>

<pre><code>pgo show user hippo --show-system-accounts
</code></pre>

<p>The standby cluster will take a few moments to bootstrap, but it is now set up!</p>

<h3 id="promoting-a-standby-cluster">Promoting a Standby Cluster</h3>

<p>Before promoting a standby cluster, it is first necessary to shut down the
primary cluster, otherwise you can run into a potential &ldquo;<a href="https://en.wikipedia.org/wiki/Split-brain_(computing)">split-brain</a>&ldquo;
scenario (if your primary Kubernetes cluster is down, it may not be possible to
do this).</p>

<p>To shutdown, run the following command:</p>

<pre><code>pgo update cluster hippo --shutdown
</code></pre>

<p>Once it is shut down, you can promote the standby cluster:</p>

<pre><code>pgo update cluster hippo-standby --promote-standby
</code></pre>

<p>The standby is now an active PostgreSQL cluster and can start to accept writes.</p>

<p>To convert the previous active cluster into a standby cluster, you can run the
following command:</p>

<pre><code>pgo update cluster hippo --enable-standby
</code></pre>

<p>This will take a few moments to make this PostgreSQL cluster into a standby
cluster. When it is ready, you can start it up with the following command:</p>

<pre><code>pgo update cluster hippo --startup
</code></pre>

<h2 id="monitoring">Monitoring</h2>

<h3 id="view-disk-utilization">View Disk Utilization</h3>

<p>You can see a comparison of Postgres data size versus the Persistent
volume claim size by entering the following:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo df hacluster -n pgouser1</code></pre></div>
<h3 id="postgresql-metrics-via-pgmonitor">PostgreSQL Metrics via pgMonitor</h3>

<p>You can view metrics about your PostgreSQL cluster using the pgMonitor stack by
deploying the &ldquo;crunchy-collect&rdquo; sidecar with the PostgreSQL cluster:</p>

<pre><code>pgo create cluster hacluster --metrics
</code></pre>

<p>Note: To store and visualize the metrics, you must deploy Prometheus and Grafana
with yoru PostgreSQL cluster. For instructions on installing Grafana and
Prometheus in your environment, please review the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/installation/other/ansible/installing-metrics/">installation instructions</a>
for the metrics stack.</p>

<h2 id="labels">Labels</h2>

<p>Labels are a helpful way to organize PostgreSQL clusters, such as by application
type or environment. The PostgreSQL Operator supports managing Kubernetes Labels
as a convenient way to group PostgreSQL clusters together.</p>

<p>You can view which labels are assigned to a PostgreSQL cluster using the
<a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_show_cluster/"><code>pgo show cluster</code></a> command. You are also
able to see these labels when using <code>kubectl</code> or <code>oc</code>.</p>

<h3 id="add-a-label-to-a-postgresql-cluster">Add a Label to a PostgreSQL Cluster</h3>

<p>Labels can be added to PostgreSQL clusters using the <a href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/pgo_label/"><code>pgo label</code></a>
command. For example, to add a label with a key/value pair of <code>env=production</code>,
you could execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo label hacluster --label<span style="color:#f92672">=</span><span style="color:#111">env</span><span style="color:#f92672">=</span>production</code></pre></div>
<h3 id="add-a-label-to-multiple-postgresql-clusters">Add a Label to Multiple PostgreSQL Clusters</h3>

<p>You can add also add a label to multiple PostgreSQL clusters simultaneously
using the <code>--selector</code> flag on the <code>pgo label</code> command. For example, to add a
label with a key/value pair of <code>env=production</code> to clusters that have a label
key/value pair of <code>app=payment</code>, you could execute the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pgo label --selector<span style="color:#f92672">=</span><span style="color:#111">app</span><span style="color:#f92672">=</span>payment --label<span style="color:#f92672">=</span><span style="color:#111">env</span><span style="color:#f92672">=</span>production</code></pre></div>
<h2 id="policy-management">Policy Management</h2>

<h3 id="create-a-policy">Create a Policy</h3>

<p>To create a SQL policy, enter the following:</p>

<pre><code>pgo create policy mypolicy --in-file=mypolicy.sql -n pgouser1
</code></pre>

<p>This examples creates a policy named <em>mypolicy</em> using the contents
of the file <em>mypolicy.sql</em> which is assumed to be in the current
directory.</p>

<p>You can view policies as following:</p>

<pre><code>pgo show policy --all -n pgouser1
</code></pre>

<h3 id="apply-a-policy">Apply a Policy</h3>

<pre><code>pgo apply mypolicy --selector=environment=prod
pgo apply mypolicy --selector=name=hacluster
</code></pre>

<h2 id="advanced-operations">Advanced Operations</h2>

<h3 id="connection-pooling-via-pgbouncer">Connection Pooling via pgBouncer</h3>

<p>To add a pgbouncer Deployment to your Postgres cluster, enter:</p>

<pre><code>pgo create cluster hacluster --pgbouncer -n pgouser1
</code></pre>

<p>You can add pgbouncer after a Postgres cluster is created as follows:</p>

<pre><code>pgo create pgbouncer hacluster
pgo create pgbouncer --selector=name=hacluster
</code></pre>

<p>You can also specify a pgbouncer password as follows:</p>

<pre><code>pgo create cluster hacluster --pgbouncer --pgbouncer-pass=somepass -n pgouser1
</code></pre>

<p>You can remove a pgbouncer from a cluster as follows:</p>

<pre><code>pgo delete pgbouncer hacluster -n pgouser1
</code></pre>

<h3 id="query-analysis-via-pgbadger">Query Analysis via pgBadger</h3>

<p>You can create a pgbadger sidecar container in your Postgres cluster
pod as follows:</p>

<pre><code>pgo create cluster hacluster --pgbadger -n pgouser1
</code></pre>

<h3 id="create-a-cluster-using-specific-storage">Create a Cluster using Specific Storage</h3>

<pre><code>pgo create cluster hacluster --storage-config=somestorageconfig -n pgouser1
</code></pre>

<p>Likewise, you can specify a storage configuration when creating
a replica:</p>

<pre><code>pgo scale hacluster --storage-config=someslowerstorage -n pgouser1
</code></pre>

<p>This example specifies the <em>somestorageconfig</em> storage configuration
to be used by the Postgres cluster.  This lets you specify a storage
configuration that is defined in the <em>pgo.yaml</em> file specifically for
a given Postgres cluster.</p>

<p>You can create a Cluster using a Preferred Node as follows:</p>

<pre><code>pgo create cluster hacluster --node-label=speed=superfast -n pgouser1
</code></pre>

<p>That command will cause a node affinity rule to be added to the
Postgres pod which will influence the node upon which Kubernetes
will schedule the Pod.</p>

<p>Likewise, you can create a Replica using a Preferred Node as follows:</p>

<pre><code>pgo scale hacluster --node-label=speed=slowerthannormal -n pgouser1
</code></pre>

<h3 id="create-a-cluster-with-loadbalancer-servicetype">Create a Cluster with LoadBalancer ServiceType</h3>

<pre><code>pgo create cluster hacluster --service-type=LoadBalancer -n pgouser1
</code></pre>

<p>This command will cause the Postgres Service to be of a specific
type instead of the default ClusterIP service type.</p>

<h3 id="namespace-operations">Namespace Operations</h3>

<p>Create an Operator namespace where Postgres clusters can be created
and managed by the Operator:</p>

<pre><code>pgo create namespace mynamespace
</code></pre>

<p>Update a Namespace to be able to be used by the Operator:</p>

<pre><code>pgo update namespace somenamespace
</code></pre>

<p>Delete a Namespace:</p>

<pre><code>pgo delete namespace mynamespace
</code></pre>

<h3 id="postgresql-operator-user-operations">PostgreSQL Operator User Operations</h3>

<p>PGO users are users defined for authenticating to the PGO REST API.  You
can manage those users with the following commands:</p>

<pre><code>pgo create pgouser someuser --pgouser-namespaces=&quot;pgouser1,pgouser2&quot; --pgouser-password=&quot;somepassword&quot; --pgouser-roles=&quot;pgoadmin&quot;
pgo create pgouser otheruser --all-namespaces --pgouser-password=&quot;somepassword&quot; --pgouser-roles=&quot;pgoadmin&quot;
</code></pre>

<p>Update a user:</p>

<pre><code>pgo update pgouser someuser --pgouser-namespaces=&quot;pgouser1,pgouser2&quot; --pgouser-password=&quot;somepassword&quot; --pgouser-roles=&quot;pgoadmin&quot;
pgo update pgouser otheruser --all-namespaces --pgouser-password=&quot;somepassword&quot; --pgouser-roles=&quot;pgoadmin&quot;
</code></pre>

<p>Delete a PGO user:</p>

<pre><code>pgo delete pgouser someuser
</code></pre>

<p>PGO roles are also managed as follows:</p>

<pre><code>pgo create pgorole somerole --permissions=&quot;Cat,Ls&quot;
</code></pre>

<p>Delete a PGO role with:</p>

<pre><code>pgo delete pgorole somerole
</code></pre>

<p>Update a PGO role with:</p>

<pre><code>pgo update pgorole somerole --permissions=&quot;Cat,Ls&quot;
</code></pre>

<h3 id="postgresql-cluster-user-operations">PostgreSQL Cluster User Operations</h3>

<p>Managed Postgres users can be viewed using the following command:</p>

<pre><code>pgo show user hacluster
</code></pre>

<p>Postgres users can be created using the following command examples:</p>

<pre><code>pgo create user hacluster --username=somepguser --password=somepassword --managed
pgo create user --selector=name=hacluster --username=somepguser --password=somepassword --managed
</code></pre>

<p>Those commands are identical in function, and create on the hacluster Postgres cluster, a user named <em>somepguser</em>, with a password of <em>somepassword</em>, the account is <em>managed</em> meaning that
these credentials are stored as a Secret on the Kubernetes cluster in the Operator
namespace.</p>

<p>Postgres users can be deleted using the following command:</p>

<pre><code>pgo delete user hacluster --username=somepguser
</code></pre>

<p>That command deletes the user on the hacluster Postgres cluster.</p>

<p>Postgres users can be updated using the following command:</p>

<pre><code>pgo update user hacluster --username=somepguser --password=frodo
</code></pre>

<p>That command changes the password for the user on the hacluster Postgres cluster.</p>



    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/" title="Using the pgo Client"> <i class="fa fa-chevron-left"></i><label>Using the pgo Client</label></a>
    <a class="nav nav-next" href="https://crunchydata.github.io/postgres-operator/4.4.3/pgo-client/reference/" title="pgo Client Reference" style="margin-right: 0px;"><label>pgo Client Reference</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

  </div>


	<div>
	</div>
</footer>

<link href="https://crunchydata.github.io/postgres-operator/4.4.3/css/featherlight.min.css" rel="stylesheet">
<script src="https://crunchydata.github.io/postgres-operator/4.4.3/js/featherlight.min.js"></script>

<script src="https://crunchydata.github.io/postgres-operator/4.4.3/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>
